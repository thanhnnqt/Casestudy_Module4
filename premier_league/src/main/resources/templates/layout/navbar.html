<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<body>
<nav th:fragment="header" class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <!-- Logo -->
            <a th:href="@{/}" class="flex items-center gap-3">
                <div class="w-10 h-10 overflow-hidden">
                    <img th:src="@{/images/logoo.png}" alt="Logo" class="w-full h-full object-contain" />
                </div>
                <span class="text-xl font-bold text-primary">Premier League</span>
            </a>

            <!-- Desktop menu -->
            <div class="hidden md:flex items-center gap-8">
                <a th:href="@{/}" class="font-medium text-gray-700 hover:text-primary">Trang chủ</a>
                <a th:href="@{/tournament}" class="font-medium text-gray-700 hover:text-primary">Giải đấu</a>
                <a th:href="@{/ticket}" class="font-medium text-gray-700 hover:text-primary">Đặt Vé</a>
                <a th:href="@{/new}" class="font-medium text-gray-700 hover:text-primary">Tin tức</a>

                <!-- Đăng nhập -->
                <div sec:authorize="!isAuthenticated()">
                    <a th:href="@{/login}"
                       class="login-btn px-4 py-2 rounded-lg bg-primary text-white font-medium hover:bg-green-700 transition-colors">
                        Đăng Nhập
                    </a>
                </div>

                <!-- Người dùng đã đăng nhập -->
                <div sec:authorize="isAuthenticated()" class="flex items-center gap-4 border-l pl-4 ml-4">
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-primary font-bold overflow-hidden">
                            <img th:src="${#authentication.principal.attributes['picture']}" class="w-full h-full object-cover" onerror="this.style.display='none'"/>
                            <i data-lucide="user" class="w-5 h-5"></i>
                        </div>
                        <span class="text-sm font-semibold text-gray-700"
                              sec:authentication="principal.attributes['name']">User</span>
                    </div>
                    <form th:action="@{/logout}" method="post" class="m-0">
                        <button type="submit" class="flex items-center gap-1 text-red-500 hover:text-red-700 font-medium text-sm">
                            <i data-lucide="log-out" class="w-4 h-4"></i>
                            Thoát
                        </button>
                    </form>
                </div>
            </div>

            <!-- Mobile menu button -->
            <button onclick="document.getElementById('mobile-menu').classList.toggle('hidden')"
                    class="md:hidden p-2 rounded-lg hover:bg-gray-100">
                <i data-lucide="menu" class="w-6 h-6"></i>
            </button>
        </div>

        <!-- Mobile menu -->
        <div id="mobile-menu" class="hidden md:hidden py-4 border-t bg-white">
            <a th:href="@{/}" class="block py-2 px-4 font-medium hover:bg-gray-50 text-gray-700">Trang chủ</a>
            <a th:href="@{/tournaments}" class="block py-2 px-4 font-medium hover:bg-gray-50 text-gray-700">Giải đấu</a>
            <a th:href="@{/tickets}" class="block py-2 px-4 font-medium hover:bg-gray-50 text-gray-700">Đặt Vé</a>
            <div class="border-t my-2"></div>

            <!-- Đăng nhập mobile -->
            <div sec:authorize="!isAuthenticated()">
                <a th:href="@{/login}" class="login-btn block py-2 px-4 font-bold text-primary hover:bg-gray-50">
                    Đăng Nhập
                </a>
            </div>

            <!-- Người dùng đã đăng nhập mobile -->
            <div sec:authorize="isAuthenticated()">
                <div class="px-4 py-2 text-gray-500 text-sm">
                    Xin chào, <span sec:authentication="principal.attributes['name']" class="font-bold text-gray-900"></span>
                </div>
                <form th:action="@{/logout}" method="post" class="block">
                    <button type="submit" class="w-full text-left py-2 px-4 font-medium text-red-600 hover:bg-red-50 flex items-center gap-2">
                        <i data-lucide="log-out" class="w-4 h-4"></i>
                        Đăng xuất
                    </button>
                </form>
            </div>
        </div>
    </div>
</nav>
</body>
</html>
