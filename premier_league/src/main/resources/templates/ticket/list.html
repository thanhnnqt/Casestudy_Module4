<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="layout :: layout('Danh sách vé', 'dashboard', ~{::content})">

<th:block th:fragment="content">

    <style>
        :root {
            --bg-main: #050017;
            --card-bg-from: #1b2338;
            --card-bg-to: #121421;
            --accent-green: #4dff73;
            --text-main: #333; /* Điều chỉnh lại màu chữ cho nền trắng của layout */
            --text-muted: #6c757d;
        }

        /* Điều chỉnh lại màu chữ vì layout nền sáng */
        .ticket-page-wrapper { color: var(--text-main); }

        /* TITLE */
        .page-title {
            font-weight: 800; letter-spacing: 1px; text-transform: uppercase; text-align: center;
            font-size: 1.8rem; color: #38003c; margin-bottom: 6px; margin-top: 20px;
        }

        .page-subtitle { text-align: center; color: var(--text-muted); margin-bottom: 28px; font-size: 0.95rem; }

        /* ADD BUTTON */
        .btn-add {
            border-radius: 999px; padding: 0.6rem 1.4rem; font-weight: 600; letter-spacing: 0.04em;
            text-transform: uppercase; border: none;
            background: radial-gradient(circle at top, #22c55e 0, #16a34a 45%, #15803d 90%);
            color: #fff; box-shadow: 0 4px 15px rgba(21, 128, 61, 0.4); font-size: 0.85rem;
            transition: all 0.2s ease; text-decoration: none;
        }
        .btn-add:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(21, 128, 61, 0.6); color: #fff; }

        /* CARD (Giữ nguyên style tối cho card để nổi bật) */
        .ticket-card {
            position: relative; border-radius: 22px; padding: 16px;
            background: linear-gradient(135deg, #2a1a38, #120916); /* Nền tối Tím than */
            color: #f9fafb; /* Chữ trắng trong card */
            box-shadow: 0 10px 25px rgba(0,0,0,0.15); overflow: hidden;
            transition: all 0.2s ease; border: 1px solid rgba(255,255,255,0.1);
        }
        .ticket-card:hover { transform: translateY(-4px); box-shadow: 0 15px 35px rgba(0,0,0,0.25); }

        /* HEADER */
        .ticket-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .ticket-match-title { font-weight: 700; font-size: 1rem; color: #fff; }

        /* TAG */
        .ticket-tag {
            display: inline-flex; align-items: center; gap: 6px; padding: 4px 9px;
            border-radius: 999px; background: rgba(255,255,255,0.1); font-size: 0.75rem; color: #e5e7eb;
        }
        .ticket-tag-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--accent-green); box-shadow: 0 0 8px var(--accent-green); }

        /* BODY */
        .ticket-body { margin-top: 10px; font-size: 0.9rem; }
        .ticket-info-row { display: flex; align-items: center; gap: 8px; margin-bottom: 6px; color: #cbd5e1; }
        .ticket-info-label { font-weight: 600; text-transform: uppercase; font-size: 0.75rem; min-width: 80px; color: #94a3b8; }

        /* ACTION BUTTONS */
        .ticket-actions { margin-top: 15px; display: flex; gap: 10px; }
        .action-btn {
            flex: 1; padding: 8px; border-radius: 12px; text-align: center; font-weight: 600; font-size: 0.85rem; text-decoration: none; transition: all 0.2s;
        }
        .delete-btn { background: rgba(220, 38, 38, 0.2); color: #fca5a5; border: 1px solid rgba(220, 38, 38, 0.3); }
        .delete-btn:hover { background: rgba(220, 38, 38, 0.3); color: #fff; }

        .empty-message { text-align: center; margin-top: 32px; color: var(--text-muted); }
    </style>

    <div class="container-fluid ticket-page-wrapper">

        <h2 class="page-title">Quản lý vé trận đấu</h2>
        <p th:if="${ticketList != null and !#lists.isEmpty(ticketList)}" class="page-subtitle">Danh sách vé xem bóng đá đã tạo.</p>

        <div class="d-flex justify-content-end mb-4">
            <a th:href="@{/owner/tickets/__${teamId}__/optionToCreateTicket}" class="btn-add">
                <i class="bi bi-plus-lg me-1"></i> Thêm vé mới
            </a>
        </div>

        <div th:if="${ticketList != null and !#lists.isEmpty(ticketList)}" class="row g-4">
            <div class="col-xl-3 col-lg-4 col-md-6 col-12" th:each="ticket : ${ticketList}">
                <div class="ticket-card">

                    <div class="ticket-header">
                        <div class="ticket-match-title">
                            <span th:text="${ticket.homeTeam}"></span>
                            <span class="mx-1 text-muted small">vs</span>
                            <span th:text="${ticket.awayTeam}"></span>
                        </div>
                        <div class="ticket-tag">
                            <span class="ticket-tag-dot"></span>
                            <span th:text="${ticket.dateMatch}"></span>
                        </div>
                    </div>

                    <div class="ticket-body">
                        <div class="ticket-info-row"><span class="ticket-info-label">Sân</span><span th:text="${ticket.stadium}"></span></div>
                        <div class="ticket-info-row"><span class="ticket-info-label">Giờ đấu</span><span th:text="${ticket.timeMatch}"></span></div>
                        <div class="ticket-info-row"><span class="ticket-info-label">Địa chỉ</span><span class="text-truncate" th:text="${ticket.address}"></span></div>
                        <div class="ticket-info-row"><span class="ticket-info-label">Số lượng</span><span class="fw-bold text-white" th:text="${ticket.quantity}"></span></div>
                    </div>

                    <div class="ticket-actions">
                        <a href="#" class="action-btn delete-btn" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal"
                           th:attr="data-delete-url=@{/owner/tickets/__${teamId}__/delete/__${ticket.id}__}">
                            <i class="bi bi-trash"></i> Xóa vé
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div th:if="${mess}" class="empty-message">
            <div class="alert alert-info d-inline-block shadow-sm border-0">
                <i class="bi bi-info-circle me-2"></i> <span th:text="${mess}"></span>
            </div>
        </div>

    </div>

    <div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title">Xác nhận xóa</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center p-4">
                    <p class="mb-0">Bạn có chắc chắn muốn xóa loại vé này không?<br><small class="text-muted">Hành động này không thể hoàn tác.</small></p>
                </div>
                <div class="modal-footer justify-content-center border-0">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Hủy</button>
                    <a href="#" id="confirmDeleteBtn" class="btn btn-danger fw-bold">Xóa ngay</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var confirmDeleteModal = document.getElementById('confirmDeleteModal');
            var confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            confirmDeleteModal.addEventListener('show.bs.modal', function (event) {
                var button = event.relatedTarget;
                var deleteUrl = button.getAttribute('data-delete-url');
                confirmDeleteBtn.setAttribute('href', deleteUrl);
            });
        });
    </script>

</th:block>
</html>